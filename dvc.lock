schema: '2.0'
stages:
  train:
    cmd: python -m src.train --specs-dir data/tiered_imagenet/specs --distances-dir
      data/tiered_imagenet/distances --metrics-dir data/tiered_imagenet/metrics --tb-log-dir
      data/tiered_imagenet/tb_logs/semantic_one --output-model data/tiered_imagenet/models/trained_model.tar
      &> data/tiered_imagenet/logs/train.out
    deps:
    - path: data/tiered_imagenet/distances/train.csv
      md5: daecfc11832898acdea1ceb04bbae72c
      size: 2252160
    - path: data/tiered_imagenet/specs/train.json
      md5: 3d8a420c1257c8d0c3dc3e1cbe3403a8
      size: 30593
    - path: data/tiered_imagenet/specs/val.json
      md5: 64dde6b03b773bdf5b65c3dd04770e81
      size: 8495
    - path: src/train.py
      md5: e974e9f819c72d598eb0ab513a10b17d
      size: 3145
    outs:
    - path: data/tiered_imagenet/logs/train.out
      md5: fd15927232b5c616eb4960987211f244
      size: 5879
    - path: data/tiered_imagenet/metrics/training_tasks.pkl
      md5: 7081acff92cf5e498dbcfc7a99173f33
      size: 20329
    - path: data/tiered_imagenet/models/trained_model.tar
      md5: 844511084c5dede741d9dacdb5b8c614
      size: 44787200
  compute_distances@test:
    cmd: python -m src.compute_semantic_distances --split test --specs-dir data/tiered_imagenet/specs
      --output-dir data/tiered_imagenet/distances &> data/tiered_imagenet/logs/compute_test_distances.out
    deps:
    - path: data/tiered_imagenet/specs/test.json
      md5: 522a3fae2c4919b3b1d02c7f1221cc20
      size: 13976
    - path: data/tiered_imagenet/specs/wordnet.is_a.txt
      md5: 26d5d2bf0f43a269950ae5f551dfadbd
      size: 1517000
    - path: src/compute_semantic_distances.py
      md5: a3ddcd1af0e684ca68b5ded994f5ced4
      size: 1079
    outs:
    - path: data/tiered_imagenet/distances/test.csv
      md5: 84de996abe3b91d74ae9599578a9fc90
      size: 467358
    - path: data/tiered_imagenet/logs/compute_test_distances.out
      md5: e07cfd43950fe9bc70bb5a03fd771e95
      size: 9454
  compute_distances@train:
    cmd: python -m src.compute_semantic_distances --split train --specs-dir data/tiered_imagenet/specs
      --output-dir data/tiered_imagenet/distances &> data/tiered_imagenet/logs/compute_train_distances.out
    deps:
    - path: data/tiered_imagenet/specs/train.json
      md5: 3d8a420c1257c8d0c3dc3e1cbe3403a8
      size: 30593
    - path: data/tiered_imagenet/specs/wordnet.is_a.txt
      md5: 26d5d2bf0f43a269950ae5f551dfadbd
      size: 1517000
    - path: src/compute_semantic_distances.py
      md5: a3ddcd1af0e684ca68b5ded994f5ced4
      size: 1079
    outs:
    - path: data/tiered_imagenet/distances/train.csv
      md5: daecfc11832898acdea1ceb04bbae72c
      size: 2252160
    - path: data/tiered_imagenet/logs/compute_train_distances.out
      md5: 54284a60f2dc73d1314fffa7e84476c6
      size: 22591
  evaluate:
    cmd: python -m src.evaluate --specs-dir data/tiered_imagenet/specs --trained-model
      data/tiered_imagenet/models/trained_model.tar --output-dir data/tiered_imagenet/metrics
      &> data/tiered_imagenet/logs/evaluate.out
    deps:
    - path: data/tiered_imagenet/models/trained_model.tar
      md5: 844511084c5dede741d9dacdb5b8c614
      size: 44787200
    - path: data/tiered_imagenet/specs/test.json
      md5: 522a3fae2c4919b3b1d02c7f1221cc20
      size: 13976
    - path: src/evaluate.py
      md5: e5b3f77d2e31d38b90e7036bf8a828a7
      size: 1746
    outs:
    - path: data/tiered_imagenet/logs/evaluate.out
      md5: 0f1542010992eb5fe7aabd283a3a08c4
      size: 1410
    - path: data/tiered_imagenet/metrics/raw_results.csv
      md5: 130ba28ddd983b9cd67ac2a443bc9219
      size: 231202
  compute_metrics:
    cmd: python -m src.compute_metrics --distances-dir data/tiered_imagenet/distances
      --metrics-dir data/tiered_imagenet/metrics &> data/tiered_imagenet/logs/compute_metrics.out
    deps:
    - path: data/tiered_imagenet/distances/test.csv
      md5: 84de996abe3b91d74ae9599578a9fc90
      size: 467358
    - path: data/tiered_imagenet/metrics/raw_results.csv
      md5: 130ba28ddd983b9cd67ac2a443bc9219
      size: 231202
    - path: src/compute_metrics.py
      md5: 23db77dcf154ac1c0cd286dc9001f4eb
      size: 1788
    outs:
    - path: data/tiered_imagenet/logs/compute_metrics.out
      md5: 44c4ab8319dce45bfdcd81592c82f69a
      size: 441
    - path: data/tiered_imagenet/metrics/accuracy_v_task_class_distance.png
      md5: 3ebf7f474a8fbd927a6fcb9b97d8fb59
      size: 15714
    - path: data/tiered_imagenet/metrics/task_performances.csv
      md5: d3f5cd209e5022ac44de42d3c43da96c
      size: 945
